import {
  Component,
  EventEmitter,
  OnDestroy,
  OnInit,
  Output,
  ViewChild,
} from '@angular/core';
import { ButtonComponent } from '../../../layout/button/button.component';
import { FormBuilder, FormGroup, Validators } from '@angular/forms';
import { ExchangeService } from '../../../../services/exchange.service';
import { ExchangeOrder, TradingPair } from '../../../../app.datatypes';
import { ISubscription } from 'rxjs/Subscription';
import { Observable } from 'rxjs/Observable';
import 'rxjs/add/observable/merge';
import { MatSnackBar } from '@angular/material';
import { showSnackbarError } from '../../../../utils/errors';

@Component({
  selector: 'app-exchange-create',
  templateUrl: './exchange-create.component.html',
  styleUrls: ['./exchange-create.component.scss'],
})
export class ExchangeCreateComponent implements OnInit, OnDestroy {
  @ViewChild('exchangeButton') exchangeButton: ButtonComponent;
  @Output() submitted = new EventEmitter<ExchangeOrder>();
  form: FormGroup;
  tradingPairs: TradingPair[] = [{"from":"LTC","to":"SALT","price":108.4857,"pair":"LTC/SALT","min":7.183908,"max":718.390805},{"from":"LTC","to":"DCR","price":1.53563,"pair":"LTC/DCR","min":7.183908,"max":718.390805},{"from":"XRP","to":"SALT","price":1.38307,"pair":"XRP/SALT","min":564.334086,"max":56433.408578},{"from":"XRP","to":"SKY","price":0.3450178,"pair":"XRP/SKY","min":564.334086,"max":56433.408578},{"from":"BNB","to":"SALT","price":20.6164,"pair":"BNB/SALT","min":36.968577,"max":3696.857671},{"from":"BNB","to":"DGD","price":0.331364285714286,"pair":"BNB/DGD","min":36.968577,"max":3696.857671},{"from":"LTC","to":"XRP","price":77.8575,"pair":"LTC/XRP","min":7.183908,"max":718.390805},{"from":"XRP","to":"RLC","price":1.729331,"pair":"XRP/RLC","min":564.334086,"max":56433.408578},{"from":"XMR","to":"QTUM","price":25.761,"pair":"XMR/QTUM","min":3.94011,"max":394.011032},{"from":"LTC","to":"XLM","price":205.6999,"pair":"LTC/XLM","min":7.183908,"max":718.390805},{"from":"BNB","to":"BRD","price":24.5357142857143,"pair":"BNB/BRD","min":36.968577,"max":3696.857671},{"from":"BNB","to":"STRAT","price":7.0506,"pair":"BNB/STRAT","min":36.968577,"max":3696.857671},{"from":"XMR","to":"SC","price":18017.78625,"pair":"XMR/SC","min":3.94011,"max":394.011032},{"from":"LTC","to":"SUB","price":543.875,"pair":"LTC/SUB","min":7.183908,"max":718.390805},{"from":"BTC","to":"ZIL","price":252631.455725191,"pair":"BTC/ZIL","min":0.05,"max":5.0},{"from":"BTC","to":"BRD","price":18335.3233532934,"pair":"BTC/BRD","min":0.05,"max":5.0},{"from":"BNB","to":"FUN","price":1150.19571428571,"pair":"BNB/FUN","min":36.968577,"max":3696.857671},{"from":"XMR","to":"SUB","price":992.83125,"pair":"XMR/SUB","min":3.94011,"max":394.011032},{"from":"XMR","to":"LRC","price":1192.725,"pair":"XMR/LRC","min":3.94011,"max":394.011032},{"from":"ETH","to":"LTC","price":3.690225,"pair":"ETH/LTC","min":1.933264,"max":193.326374},{"from":"ETH","to":"XRP","price":289.74375,"pair":"ETH/XRP","min":1.933264,"max":193.326374},{"from":"BNB","to":"XZC","price":0.928742857142857,"pair":"BNB/XZC","min":36.968577,"max":3696.857671},{"from":"LTC","to":"GNT","price":360.488,"pair":"LTC/GNT","min":7.183908,"max":718.390805},{"from":"LTC","to":"CVC","price":433.442,"pair":"LTC/CVC","min":7.183908,"max":718.390805},{"from":"LTC","to":"DGD","price":1.72085,"pair":"LTC/DGD","min":7.183908,"max":718.390805},{"from":"LTC","to":"KNC","price":176.269,"pair":"LTC/KNC","min":7.183908,"max":718.390805},{"from":"BTC","to":"STEEM","price":13940.2460455192,"pair":"BTC/STEEM","min":0.05,"max":5.0},{"from":"BNB","to":"LRC","price":124.167142857143,"pair":"BNB/LRC","min":36.968577,"max":3696.857671},{"from":"ETH","to":"SNT","price":6048.15,"pair":"ETH/SNT","min":1.933264,"max":193.326374},{"from":"BNB","to":"BNT","price":8.75985714285714,"pair":"BNB/BNT","min":36.968577,"max":3696.857671},{"from":"XMR","to":"XZC","price":8.804375,"pair":"XMR/XZC","min":3.94011,"max":394.011032},{"from":"XMR","to":"MANA","price":788.675,"pair":"XMR/MANA","min":3.94011,"max":394.011032},{"from":"XRP","to":"REP","price":0.0507963,"pair":"XRP/REP","min":564.334086,"max":56433.408578},{"from":"ETH","to":"EOS","price":47.381,"pair":"ETH/EOS","min":1.933264,"max":193.326374},{"from":"XRP","to":"TUSD","price":0.293546,"pair":"XRP/TUSD","min":564.334086,"max":56433.408578},{"from":"XRP","to":"XVG","price":52.68249,"pair":"XRP/XVG","min":564.334086,"max":56433.408578},{"from":"XMR","to":"STRAT","price":67.7255,"pair":"XMR/STRAT","min":3.94011,"max":394.011032},{"from":"ETH","to":"REP","price":14.828225,"pair":"ETH/REP","min":1.933264,"max":193.326374},{"from":"LTC","to":"STORM","price":8511.85,"pair":"LTC/STORM","min":7.183908,"max":718.390805},{"from":"BTC","to":"XLM","price":29597.6054992548,"pair":"BTC/XLM","min":0.05,"max":5.0},{"from":"XRP","to":"DOCK","price":32.2721,"pair":"XRP/DOCK","min":564.334086,"max":56433.408578},{"from":"XMR","to":"POWR","price":637.12375,"pair":"XMR/POWR","min":3.94011,"max":394.011032},{"from":"BTC","to":"ICX","price":16745.3425632378,"pair":"BTC/ICX","min":0.05,"max":5.0},{"from":"XRP","to":"STEEM","price":1.235105,"pair":"XRP/STEEM","min":564.334086,"max":56433.408578},{"from":"LTC","to":"TRX","price":1783.28,"pair":"LTC/TRX","min":7.183908,"max":718.390805},{"from":"XRP","to":"DASH","price":0.004593,"pair":"XRP/DASH","min":564.334086,"max":56433.408578},{"from":"XMR","to":"XVG","price":7543.22375,"pair":"XMR/XVG","min":3.94011,"max":394.011032},{"from":"XRP","to":"STRAT","price":0.472999,"pair":"XRP/STRAT","min":564.334086,"max":56433.408578},{"from":"XMR","to":"DNT","price":3203.7375,"pair":"XMR/DNT","min":3.94011,"max":394.011032},{"from":"ETH","to":"POWR","price":1298.8975,"pair":"ETH/POWR","min":1.933264,"max":193.326374},{"from":"BNB","to":"REP","price":0.767228571428571,"pair":"BNB/REP","min":36.968577,"max":3696.857671},{"from":"XRP","to":"XMR","price":0.00693019,"pair":"XRP/XMR","min":564.334086,"max":56433.408578},{"from":"BTC","to":"RLC","price":19518.8123505976,"pair":"BTC/RLC","min":0.05,"max":5.0},{"from":"BTC","to":"FUN","price":859516.122807017,"pair":"BTC/FUN","min":0.05,"max":5.0},{"from":"BNB","to":"NANO","price":5.47571428571429,"pair":"BNB/NANO","min":36.968577,"max":3696.857671},{"from":"ETH","to":"GNT","price":1341.57,"pair":"ETH/GNT","min":1.933264,"max":193.326374},{"from":"XMR","to":"TUSD","price":42.03075,"pair":"XMR/TUSD","min":3.94011,"max":394.011032},{"from":"XRP","to":"BAT","price":2.2001,"pair":"XRP/BAT","min":564.334086,"max":56433.408578},{"from":"ETH","to":"WINGS","price":1315.0725,"pair":"ETH/WINGS","min":1.933264,"max":193.326374},{"from":"XMR","to":"ETC","price":11.011375,"pair":"XMR/ETC","min":3.94011,"max":394.011032},{"from":"BNB","to":"SKY","price":5.14288714285714,"pair":"BNB/SKY","min":36.968577,"max":3696.857671},{"from":"LTC","to":"SKY","price":27.06401,"pair":"LTC/SKY","min":7.183908,"max":718.390805},{"from":"XRP","to":"BNB","price":0.065052,"pair":"XRP/BNB","min":564.334086,"max":56433.408578},{"from":"ETH","to":"BAT","price":642.25,"pair":"ETH/BAT","min":1.933264,"max":193.326374},{"from":"LTC","to":"BNB","price":5.1025,"pair":"LTC/BNB","min":7.183908,"max":718.390805},{"from":"ETH","to":"NAS","price":158.6065,"pair":"ETH/NAS","min":1.933264,"max":193.326374},{"from":"XMR","to":"LTC","price":1.8101125,"pair":"XMR/LTC","min":3.94011,"max":394.011032},{"from":"LTC","to":"POWR","price":349.019,"pair":"LTC/POWR","min":7.183908,"max":718.390805},{"from":"LTC","to":"XMR","price":0.543619,"pair":"LTC/XMR","min":7.183908,"max":718.390805},{"from":"ETH","to":"XEM","price":1261.9,"pair":"ETH/XEM","min":1.933264,"max":193.326374},{"from":"ETH","to":"DOCK","price":9420.725,"pair":"ETH/DOCK","min":1.933264,"max":193.326374},{"from":"BNB","to":"LOOM","price":101.41,"pair":"BNB/LOOM","min":36.968577,"max":3696.857671},{"from":"XMR","to":"DGD","price":3.1413375,"pair":"XMR/DGD","min":3.94011,"max":394.011032},{"from":"ETH","to":"BTG","price":7.522475,"pair":"ETH/BTG","min":1.933264,"max":193.326374},{"from":"ETH","to":"KNC","price":655.9975,"pair":"ETH/KNC","min":1.933264,"max":193.326374},{"from":"BTC","to":"SKY","price":3894.10764705882,"pair":"BTC/SKY","min":0.05,"max":5.0},{"from":"ETH","to":"GTO","price":4107.225,"pair":"ETH/GTO","min":1.933264,"max":193.326374},{"from":"LTC","to":"ZIL","price":1755.657,"pair":"LTC/ZIL","min":7.183908,"max":718.390805},{"from":"XRP","to":"AGI","price":8.649397,"pair":"XRP/AGI","min":564.334086,"max":56433.408578},{"from":"XRP","to":"IOST","price":77.16178,"pair":"XRP/IOST","min":564.334086,"max":56433.408578},{"from":"BNB","to":"LSK","price":3.74147142857143,"pair":"BNB/LSK","min":36.968577,"max":3696.857671},{"from":"ETH","to":"LSK","price":73.26975,"pair":"ETH/LSK","min":1.933264,"max":193.326374},{"from":"LTC","to":"WINGS","price":353.369,"pair":"LTC/WINGS","min":7.183908,"max":718.390805},{"from":"BTC","to":"LSK","price":2832.99557774608,"pair":"BTC/LSK","min":0.05,"max":5.0},{"from":"XMR","to":"SNT","price":2966.65,"pair":"XMR/SNT","min":3.94011,"max":394.011032},{"from":"LTC","to":"SYS","price":761.84,"pair":"LTC/SYS","min":7.183908,"max":718.390805},{"from":"ETH","to":"GRS","price":396.02,"pair":"ETH/GRS","min":1.933264,"max":193.326374},{"from":"XMR","to":"EOS","price":23.24075,"pair":"XMR/EOS","min":3.94011,"max":394.011032},{"from":"XMR","to":"STORM","price":15537.975,"pair":"XMR/STORM","min":3.94011,"max":394.011032},{"from":"XMR","to":"DOCK","price":4620.925,"pair":"XMR/DOCK","min":3.94011,"max":394.011032},{"from":"XRP","to":"WINGS","price":4.50499,"pair":"XRP/WINGS","min":564.334086,"max":56433.408578},{"from":"ETH","to":"BRD","price":474.2,"pair":"ETH/BRD","min":1.933264,"max":193.326374},{"from":"LTC","to":"AE","price":60.4744,"pair":"LTC/AE","min":7.183908,"max":718.390805},{"from":"XRP","to":"PHX","price":37.4381,"pair":"XRP/PHX","min":564.334086,"max":56433.408578},{"from":"ETH","to":"STRAT","price":138.0725,"pair":"ETH/STRAT","min":1.933264,"max":193.326374},{"from":"XMR","to":"STORJ","price":328.39625,"pair":"XMR/STORJ","min":3.94011,"max":394.011032},{"from":"XRP","to":"POWR","price":4.44959,"pair":"XRP/POWR","min":564.334086,"max":56433.408578},{"from":"BNB","to":"GTO","price":212.512857142857,"pair":"BNB/GTO","min":36.968577,"max":3696.857671},{"from":"LTC","to":"GTO","price":1103.62,"pair":"LTC/GTO","min":7.183908,"max":718.390805},{"from":"LTC","to":"DOCK","price":2531.38,"pair":"LTC/DOCK","min":7.183908,"max":718.390805},{"from":"XRP","to":"SUB","price":6.93385,"pair":"XRP/SUB","min":564.334086,"max":56433.408578},{"from":"ETH","to":"QTUM","price":52.519,"pair":"ETH/QTUM","min":1.933264,"max":193.326374},{"from":"XMR","to":"ETH","price":0.4867125,"pair":"XMR/ETH","min":3.94011,"max":394.011032},{"from":"XMR","to":"FUN","price":10903.8375,"pair":"XMR/FUN","min":3.94011,"max":394.011032},{"from":"LTC","to":"XVG","price":4132.539,"pair":"LTC/XVG","min":7.183908,"max":718.390805},{"from":"BTC","to":"XEM","price":48792.0687960688,"pair":"BTC/XEM","min":0.05,"max":5.0},{"from":"XRP","to":"BNT","price":0.57989,"pair":"XRP/BNT","min":564.334086,"max":56433.408578},{"from":"ETH","to":"XMR","price":2.0229725,"pair":"ETH/XMR","min":1.933264,"max":193.326374},{"from":"XRP","to":"RVN","price":22.6751,"pair":"XRP/RVN","min":564.334086,"max":56433.408578},{"from":"BTC","to":"XZC","price":694.030991501416,"pair":"BTC/XZC","min":0.05,"max":5.0},{"from":"ETH","to":"RVN","price":6619.025,"pair":"ETH/RVN","min":1.933264,"max":193.326374},{"from":"XMR","to":"AGI","price":1238.474625,"pair":"XMR/AGI","min":3.94011,"max":394.011032},{"from":"ETH","to":"AE","price":225.06025,"pair":"ETH/AE","min":1.933264,"max":193.326374},{"from":"ETH","to":"STORM","price":31677.425,"pair":"ETH/STORM","min":1.933264,"max":193.326374},{"from":"XMR","to":"SKY","price":49.40065,"pair":"XMR/SKY","min":3.94011,"max":394.011032},{"from":"BNB","to":"TUSD","price":4.37637142857143,"pair":"BNB/TUSD","min":36.968577,"max":3696.857671},{"from":"XRP","to":"ZEC","price":0.0055706,"pair":"XRP/ZEC","min":564.334086,"max":56433.408578},{"from":"XMR","to":"XRP","price":142.121875,"pair":"XMR/XRP","min":3.94011,"max":394.011032},{"from":"LTC","to":"ZEC","price":0.43696,"pair":"LTC/ZEC","min":7.183908,"max":718.390805},{"from":"BTC","to":"ELF","price":31670.0411483254,"pair":"BTC/ELF","min":0.05,"max":5.0},{"from":"BTC","to":"GRS","price":15312.3,"pair":"BTC/GRS","min":0.05,"max":5.0},{"from":"BTC","to":"WINGS","price":50848.1532433835,"pair":"BTC/WINGS","min":0.05,"max":5.0},{"from":"BTC","to":"BNT","price":6546.20090860502,"pair":"BTC/BNT","min":0.05,"max":5.0},{"from":"BTC","to":"RVN","price":255926.835051546,"pair":"BTC/RVN","min":0.05,"max":5.0},{"from":"BNB","to":"EOS","price":2.41948571428571,"pair":"BNB/EOS","min":36.968577,"max":3696.857671},{"from":"ETH","to":"XLM","price":765.47475,"pair":"ETH/XLM","min":1.933264,"max":193.326374},{"from":"XRP","to":"XEM","price":4.3229,"pair":"XRP/XEM","min":564.334086,"max":56433.408578},{"from":"XMR","to":"STEEM","price":176.845875,"pair":"XMR/STEEM","min":3.94011,"max":394.011032},{"from":"LTC","to":"QTUM","price":14.113,"pair":"LTC/QTUM","min":7.183908,"max":718.390805},{"from":"ETH","to":"CVC","price":1613.105,"pair":"ETH/CVC","min":1.933264,"max":193.326374},{"from":"XMR","to":"GTO","price":2014.625,"pair":"XMR/GTO","min":3.94011,"max":394.011032},{"from":"XRP","to":"LRC","price":8.3299,"pair":"XRP/LRC","min":564.334086,"max":56433.408578},{"from":"XMR","to":"BAT","price":315.025,"pair":"XMR/BAT","min":3.94011,"max":394.011032},{"from":"ETH","to":"POE","price":18497.725,"pair":"ETH/POE","min":1.933264,"max":193.326374},{"from":"LTC","to":"SNT","price":1625.15,"pair":"LTC/SNT","min":7.183908,"max":718.390805},{"from":"LTC","to":"NAS","price":42.621,"pair":"LTC/NAS","min":7.183908,"max":718.390805},{"from":"XRP","to":"BTC","price":8.793015e-05,"pair":"XRP/BTC","min":564.334086,"max":56433.408578},{"from":"ETH","to":"PHX","price":10928.45,"pair":"ETH/PHX","min":1.933264,"max":193.326374},{"from":"ETH","to":"XVG","price":15378.3975,"pair":"ETH/XVG","min":1.933264,"max":193.326374},{"from":"XRP","to":"MANA","price":5.508,"pair":"XRP/MANA","min":564.334086,"max":56433.408578},{"from":"XRP","to":"AE","price":0.770979,"pair":"XRP/AE","min":564.334086,"max":56433.408578},{"from":"XRP","to":"OMG","price":0.23457,"pair":"XRP/OMG","min":564.334086,"max":56433.408578},{"from":"ETH","to":"STEEM","price":360.5365,"pair":"ETH/STEEM","min":1.933264,"max":193.326374},{"from":"BNB","to":"SNT","price":312.937142857143,"pair":"BNB/SNT","min":36.968577,"max":3696.857671},{"from":"XMR","to":"ZEC","price":0.797625,"pair":"XMR/ZEC","min":3.94011,"max":394.011032},{"from":"LTC","to":"BTC","price":0.006896385,"pair":"LTC/BTC","min":7.183908,"max":718.390805},{"from":"BTC","to":"EOS","price":1832.00332103321,"pair":"BTC/EOS","min":0.05,"max":5.0},{"from":"BNB","to":"RLC","price":26.1198714285714,"pair":"BNB/RLC","min":36.968577,"max":3696.857671},{"from":"ETH","to":"SYS","price":2835.05,"pair":"ETH/SYS","min":1.933264,"max":193.326374},{"from":"BTC","to":"OMG","price":2647.58,"pair":"BTC/OMG","min":0.05,"max":5.0},{"from":"BNB","to":"QTUM","price":2.68185714285714,"pair":"BNB/QTUM","min":36.968577,"max":3696.857671},{"from":"XMR","to":"ELF","price":401.755,"pair":"XMR/ELF","min":3.94011,"max":394.011032},{"from":"XMR","to":"AION","price":376.0345,"pair":"XMR/AION","min":3.94011,"max":394.011032},{"from":"XMR","to":"RLC","price":247.616125,"pair":"XMR/RLC","min":3.94011,"max":394.011032},{"from":"XMR","to":"WINGS","price":645.04875,"pair":"XMR/WINGS","min":3.94011,"max":394.011032},{"from":"XMR","to":"SALT","price":198.036625,"pair":"XMR/SALT","min":3.94011,"max":394.011032},{"from":"XMR","to":"XLM","price":375.474875,"pair":"XMR/XLM","min":3.94011,"max":394.011032},{"from":"BTC","to":"STORM","price":1224810.0,"pair":"BTC/STORM","min":0.05,"max":5.0},{"from":"BTC","to":"SALT","price":15610.6075471698,"pair":"BTC/SALT","min":0.05,"max":5.0},{"from":"BTC","to":"ZEC","price":62.8749392097264,"pair":"BTC/ZEC","min":0.05,"max":5.0},{"from":"BTC","to":"DOCK","price":364253.267657993,"pair":"BTC/DOCK","min":0.05,"max":5.0},{"from":"ETH","to":"SALT","price":403.73925,"pair":"ETH/SALT","min":1.933264,"max":193.326374},{"from":"ETH","to":"LRC","price":2431.625,"pair":"ETH/LRC","min":1.933264,"max":193.326374},{"from":"XMR","to":"IOST","price":11048.485,"pair":"XMR/IOST","min":3.94011,"max":394.011032},{"from":"XMR","to":"BTG","price":3.6897375,"pair":"XMR/BTG","min":3.94011,"max":394.011032},{"from":"BTC","to":"SYS","price":109618.686800895,"pair":"BTC/SYS","min":0.05,"max":5.0},{"from":"BTC","to":"BNB","price":734.23882265937,"pair":"BTC/BNB","min":0.05,"max":5.0},{"from":"XRP","to":"XZC","price":0.06149,"pair":"XRP/XZC","min":564.334086,"max":56433.408578},{"from":"LTC","to":"LSK","price":19.689,"pair":"LTC/LSK","min":7.183908,"max":718.390805},{"from":"BTC","to":"AE","price":8701.97477797513,"pair":"BTC/AE","min":0.05,"max":5.0},{"from":"ETH","to":"ETC","price":22.449,"pair":"ETH/ETC","min":1.933264,"max":193.326374},{"from":"XRP","to":"LTC","price":0.0126419,"pair":"XRP/LTC","min":564.334086,"max":56433.408578},{"from":"LTC","to":"ETC","price":6.0325,"pair":"LTC/ETC","min":7.183908,"max":718.390805},{"from":"BTC","to":"STORJ","price":25887.377675033,"pair":"BTC/STORJ","min":0.05,"max":5.0},{"from":"BTC","to":"SUB","price":78262.2603833866,"pair":"BTC/SUB","min":0.05,"max":5.0},{"from":"BTC","to":"PAX","price":null,"pair":"BTC/PAX","min":0.05,"max":5.0},{"from":"BTC","to":"GNT","price":51872.6777429467,"pair":"BTC/GNT","min":0.05,"max":5.0},{"from":"BNB","to":"SYS","price":146.691428571429,"pair":"BNB/SYS","min":36.968577,"max":3696.857671},{"from":"XRP","to":"POE","price":63.3669,"pair":"XRP/POE","min":564.334086,"max":56433.408578},{"from":"BNB","to":"AION","price":39.1473142857143,"pair":"BNB/AION","min":36.968577,"max":3696.857671},{"from":"XRP","to":"DCR","price":0.0195769,"pair":"XRP/DCR","min":564.334086,"max":56433.408578},{"from":"XRP","to":"BRD","price":1.6244,"pair":"XRP/BRD","min":564.334086,"max":56433.408578},{"from":"XRP","to":"LSK","price":0.251002,"pair":"XRP/LSK","min":564.334086,"max":56433.408578},{"from":"BNB","to":"BTG","price":0.384127142857143,"pair":"BNB/BTG","min":36.968577,"max":3696.857671},{"from":"LTC","to":"RVN","price":1778.68,"pair":"LTC/RVN","min":7.183908,"max":718.390805},{"from":"BTC","to":"DGD","price":247.622370482689,"pair":"BTC/DGD","min":0.05,"max":5.0},{"from":"BTC","to":"LOOM","price":75781.7300850735,"pair":"BTC/LOOM","min":0.05,"max":5.0},{"from":"BTC","to":"LTC","price":142.6919156488,"pair":"BTC/LTC","min":0.05,"max":5.0},{"from":"BTC","to":"XRP","price":11203.6313042988,"pair":"BTC/XRP","min":0.05,"max":5.0},{"from":"LTC","to":"STORJ","price":179.897,"pair":"LTC/STORJ","min":7.183908,"max":718.390805},{"from":"BTC","to":"STRAT","price":5338.60967741935,"pair":"BTC/STRAT","min":0.05,"max":5.0},{"from":"XMR","to":"GNT","price":658.0475,"pair":"XMR/GNT","min":3.94011,"max":394.011032},{"from":"XRP","to":"DGD","price":0.0219388,"pair":"XRP/DGD","min":564.334086,"max":56433.408578},{"from":"ETH","to":"ICX","price":433.08475,"pair":"ETH/ICX","min":1.933264,"max":193.326374},{"from":"XMR","to":"NANO","price":52.59775,"pair":"XMR/NANO","min":3.94011,"max":394.011032},{"from":"LTC","to":"NANO","price":28.8155,"pair":"LTC/NANO","min":7.183908,"max":718.390805},{"from":"XRP","to":"EOS","price":0.162314,"pair":"XRP/EOS","min":564.334086,"max":56433.408578},{"from":"ETH","to":"MANA","price":1607.875,"pair":"ETH/MANA","min":1.933264,"max":193.326374},{"from":"BTC","to":"ETC","price":867.996993006993,"pair":"BTC/ETC","min":0.05,"max":5.0},{"from":"BNB","to":"POWR","price":67.207,"pair":"BNB/POWR","min":36.968577,"max":3696.857671},{"from":"LTC","to":"LRC","price":653.38,"pair":"LTC/LRC","min":7.183908,"max":718.390805},{"from":"LTC","to":"TUSD","price":23.0246,"pair":"LTC/TUSD","min":7.183908,"max":718.390805},{"from":"LTC","to":"STRAT","price":37.103,"pair":"LTC/STRAT","min":7.183908,"max":718.390805},{"from":"XRP","to":"NAS","price":0.543344,"pair":"XRP/NAS","min":564.334086,"max":56433.408578},{"from":"BNB","to":"ZEC","price":0.0830371428571429,"pair":"BNB/ZEC","min":36.968577,"max":3696.857671},{"from":"XMR","to":"PHX","price":5360.4875,"pair":"XMR/PHX","min":3.94011,"max":394.011032},{"from":"XRP","to":"AION","price":2.626252,"pair":"XRP/AION","min":564.334086,"max":56433.408578},{"from":"XRP","to":"SYS","price":9.7122,"pair":"XRP/SYS","min":564.334086,"max":56433.408578},{"from":"XRP","to":"ICX","price":1.483637,"pair":"XRP/ICX","min":564.334086,"max":56433.408578},{"from":"BNB","to":"AE","price":11.6448857142857,"pair":"BNB/AE","min":36.968577,"max":3696.857671},{"from":"ETH","to":"RLC","price":504.8175,"pair":"ETH/RLC","min":1.933264,"max":193.326374},{"from":"LTC","to":"AION","price":206.0094,"pair":"LTC/AION","min":7.183908,"max":718.390805},{"from":"LTC","to":"WAVES","price":15.41508,"pair":"LTC/WAVES","min":7.183908,"max":718.390805},{"from":"BTC","to":"WAVES","price":2218.00112709404,"pair":"BTC/WAVES","min":0.05,"max":5.0},{"from":"XRP","to":"STORM","price":108.516,"pair":"XRP/STORM","min":564.334086,"max":56433.408578},{"from":"XMR","to":"WAVES","price":28.137475,"pair":"XMR/WAVES","min":3.94011,"max":394.011032},{"from":"XRP","to":"QTUM","price":0.179916,"pair":"XRP/QTUM","min":564.334086,"max":56433.408578},{"from":"XRP","to":"BTG","price":0.0257699,"pair":"XRP/BTG","min":564.334086,"max":56433.408578},{"from":"XRP","to":"FUN","price":76.1516,"pair":"XRP/FUN","min":564.334086,"max":56433.408578},{"from":"BNB","to":"ETH","price":0.0506685714285714,"pair":"BNB/ETH","min":36.968577,"max":3696.857671},{"from":"BNB","to":"XVG","price":785.292714285714,"pair":"BNB/XVG","min":36.968577,"max":3696.857671},{"from":"BTC","to":"LRC","price":94019.0909090909,"pair":"BTC/LRC","min":0.05,"max":5.0},{"from":"BTC","to":"MANA","price":62169.0857858485,"pair":"BTC/MANA","min":0.05,"max":5.0},{"from":"XRP","to":"ZIL","price":22.38267,"pair":"XRP/ZIL","min":564.334086,"max":56433.408578},{"from":"LTC","to":"SC","price":9871.009,"pair":"LTC/SC","min":7.183908,"max":718.390805},{"from":"BTC","to":"GTO","price":158807.063209076,"pair":"BTC/GTO","min":0.05,"max":5.0},{"from":"BNB","to":"BAT","price":32.7957142857143,"pair":"BNB/BAT","min":36.968577,"max":3696.857671},{"from":"XMR","to":"AE","price":110.3935,"pair":"XMR/AE","min":3.94011,"max":394.011032},{"from":"BTC","to":"POE","price":715216.467153285,"pair":"BTC/POE","min":0.05,"max":5.0},{"from":"LTC","to":"DNT","price":1755.05,"pair":"LTC/DNT","min":7.183908,"max":718.390805},{"from":"ETH","to":"ZEC","price":1.626125,"pair":"ETH/ZEC","min":1.933264,"max":193.326374},{"from":"LTC","to":"ELF","price":220.084,"pair":"LTC/ELF","min":7.183908,"max":718.390805},{"from":"BNB","to":"STORJ","price":34.641,"pair":"BNB/STORJ","min":36.968577,"max":3696.857671},{"from":"BTC","to":"XVG","price":594610.678443114,"pair":"BTC/XVG","min":0.05,"max":5.0},{"from":"BNB","to":"SC","price":1900.637,"pair":"BNB/SC","min":36.968577,"max":3696.857671},{"from":"BNB","to":"RVN","price":337.997142857143,"pair":"BNB/RVN","min":36.968577,"max":3696.857671},{"from":"ETH","to":"SUB","price":2024.0875,"pair":"ETH/SUB","min":1.933264,"max":193.326374},{"from":"XMR","to":"CVC","price":791.2275,"pair":"XMR/CVC","min":3.94011,"max":394.011032},{"from":"XMR","to":"KNC","price":321.77375,"pair":"XMR/KNC","min":3.94011,"max":394.011032},{"from":"LTC","to":"DASH","price":0.36028,"pair":"LTC/DASH","min":7.183908,"max":718.390805},{"from":"XRP","to":"XLM","price":2.622299,"pair":"XRP/XLM","min":564.334086,"max":56433.408578},{"from":"BNB","to":"IOST","price":1150.194,"pair":"BNB/IOST","min":36.968577,"max":3696.857671},{"from":"BNB","to":"MANA","price":82.1042857142857,"pair":"BNB/MANA","min":36.968577,"max":3696.857671},{"from":"LTC","to":"RLC","price":135.6462,"pair":"LTC/RLC","min":7.183908,"max":718.390805},{"from":"BNB","to":"OMG","price":3.49657142857143,"pair":"BNB/OMG","min":36.968577,"max":3696.857671},{"from":"BNB","to":"XLM","price":39.0885571428571,"pair":"BNB/XLM","min":36.968577,"max":3696.857671},{"from":"XRP","to":"KNC","price":2.24719,"pair":"XRP/KNC","min":564.334086,"max":56433.408578},{"from":"BNB","to":"AGI","price":128.929957142857,"pair":"BNB/AGI","min":36.968577,"max":3696.857671},{"from":"XMR","to":"DCR","price":2.8030875,"pair":"XMR/DCR","min":3.94011,"max":394.011032},{"from":"ETH","to":"AION","price":766.623,"pair":"ETH/AION","min":1.933264,"max":193.326374},{"from":"XMR","to":"XEM","price":618.975,"pair":"XMR/XEM","min":3.94011,"max":394.011032},{"from":"ETH","to":"NANO","price":107.23125,"pair":"ETH/NANO","min":1.933264,"max":193.326374},{"from":"XMR","to":"SYS","price":1390.6125,"pair":"XMR/SYS","min":3.94011,"max":394.011032},{"from":"LTC","to":"XZC","price":4.8234,"pair":"LTC/XZC","min":7.183908,"max":718.390805},{"from":"LTC","to":"BRD","price":127.42,"pair":"LTC/BRD","min":7.183908,"max":718.390805},{"from":"BTC","to":"BAT","price":24833.4187093547,"pair":"BTC/BAT","min":0.05,"max":5.0},{"from":"XRP","to":"GRS","price":1.35658,"pair":"XRP/GRS","min":564.334086,"max":56433.408578},{"from":"BNB","to":"WINGS","price":68.0441428571429,"pair":"BNB/WINGS","min":36.968577,"max":3696.857671},{"from":"ETH","to":"LOOM","price":1959.95,"pair":"ETH/LOOM","min":1.933264,"max":193.326374},{"from":"BTC","to":"TRX","price":256588.147286822,"pair":"BTC/TRX","min":0.05,"max":5.0},{"from":"ETH","to":"SKY","price":100.7133,"pair":"ETH/SKY","min":1.933264,"max":193.326374},{"from":"XMR","to":"BNT","price":83.03625,"pair":"XMR/BNT","min":3.94011,"max":394.011032},{"from":"LTC","to":"ICX","price":116.38,"pair":"LTC/ICX","min":7.183908,"max":718.390805},{"from":"BTC","to":"XMR","price":78.2196715636077,"pair":"BTC/XMR","min":0.05,"max":5.0},{"from":"BNB","to":"WAVES","price":2.92926857142857,"pair":"BNB/WAVES","min":36.968577,"max":3696.857671},{"from":"XMR","to":"TRX","price":3255.075,"pair":"XMR/TRX","min":3.94011,"max":394.011032},{"from":"ETH","to":"DCR","price":5.714675,"pair":"ETH/DCR","min":1.933264,"max":193.326374},{"from":"XMR","to":"DASH","price":0.65765,"pair":"XMR/DASH","min":3.94011,"max":394.011032},{"from":"LTC","to":"REP","price":3.98437,"pair":"LTC/REP","min":7.183908,"max":718.390805},{"from":"BNB","to":"KNC","price":33.9427142857143,"pair":"BNB/KNC","min":36.968577,"max":3696.857671},{"from":"BNB","to":"XEM","price":64.4371428571429,"pair":"BNB/XEM","min":36.968577,"max":3696.857671},{"from":"XRP","to":"ELF","price":2.80584,"pair":"XRP/ELF","min":564.334086,"max":56433.408578},{"from":"XMR","to":"BTC","price":0.01259099175,"pair":"XMR/BTC","min":3.94011,"max":394.011032},{"from":"BTC","to":"IOST","price":870918.431578947,"pair":"BTC/IOST","min":0.05,"max":5.0},{"from":"BTC","to":"ETH","price":38.3668115942029,"pair":"BTC/ETH","min":0.05,"max":5.0},{"from":"LTC","to":"IOST","price":6052.468,"pair":"LTC/IOST","min":7.183908,"max":718.390805},{"from":"BTC","to":"SC","price":1420289.75507246,"pair":"BTC/SC","min":0.05,"max":5.0},{"from":"BNB","to":"ETC","price":1.14634285714286,"pair":"BNB/ETC","min":36.968577,"max":3696.857671},{"from":"ETH","to":"BNB","price":18.9895,"pair":"ETH/BNB","min":1.933264,"max":193.326374},{"from":"XMR","to":"ICX","price":212.431375,"pair":"XMR/ICX","min":3.94011,"max":394.011032},{"from":"XRP","to":"ETC","price":0.076904,"pair":"XRP/ETC","min":564.334086,"max":56433.408578},{"from":"XMR","to":"REP","price":7.2733375,"pair":"XMR/REP","min":3.94011,"max":394.011032},{"from":"XMR","to":"LOOM","price":961.3625,"pair":"XMR/LOOM","min":3.94011,"max":394.011032},{"from":"XMR","to":"OMG","price":33.58725,"pair":"XMR/OMG","min":3.94011,"max":394.011032},{"from":"BNB","to":"TRX","price":338.871428571429,"pair":"BNB/TRX","min":36.968577,"max":3696.857671},{"from":"XMR","to":"ZIL","price":3204.88375,"pair":"XMR/ZIL","min":3.94011,"max":394.011032},{"from":"BTC","to":"PHX","price":422552.191489362,"pair":"BTC/PHX","min":0.05,"max":5.0},{"from":"BNB","to":"BTC","price":0.00131074714285714,"pair":"BNB/BTC","min":36.968577,"max":3696.857671},{"from":"BNB","to":"XMR","price":0.103302714285714,"pair":"BNB/XMR","min":36.968577,"max":3696.857671},{"from":"LTC","to":"AGI","price":678.4397,"pair":"LTC/AGI","min":7.183908,"max":718.390805},{"from":"BNB","to":"CVC","price":83.4631428571429,"pair":"BNB/CVC","min":36.968577,"max":3696.857671},{"from":"XMR","to":"BNB","price":9.3145,"pair":"XMR/BNB","min":3.94011,"max":394.011032},{"from":"LTC","to":"BTG","price":2.02139,"pair":"LTC/BTG","min":7.183908,"max":718.390805},{"from":"BTC","to":"REP","price":573.334757167934,"pair":"BTC/REP","min":0.05,"max":5.0},{"from":"BNB","to":"DNT","price":337.947142857143,"pair":"BNB/DNT","min":36.968577,"max":3696.857671},{"from":"LTC","to":"STEEM","price":96.8846,"pair":"LTC/STEEM","min":7.183908,"max":718.390805},{"from":"ETH","to":"STORJ","price":669.5175,"pair":"ETH/STORJ","min":1.933264,"max":193.326374},{"from":"BNB","to":"GNT","price":68.5054285714286,"pair":"BNB/GNT","min":36.968577,"max":3696.857671},{"from":"BTC","to":"AION","price":29641.6910447761,"pair":"BTC/AION","min":0.05,"max":5.0},{"from":"BTC","to":"BTG","price":290.860159929701,"pair":"BTC/BTG","min":0.05,"max":5.0},{"from":"BNB","to":"ELF","price":41.8248571428571,"pair":"BNB/ELF","min":36.968577,"max":3696.857671},{"from":"BNB","to":"STORM","price":1639.02857142857,"pair":"BNB/STORM","min":36.968577,"max":3696.857671},{"from":"BNB","to":"NAS","price":8.20661428571428,"pair":"BNB/NAS","min":36.968577,"max":3696.857671},{"from":"BNB","to":"STEEM","price":18.6548857142857,"pair":"BNB/STEEM","min":36.968577,"max":3696.857671},{"from":"XMR","to":"NAS","price":77.797625,"pair":"XMR/NAS","min":3.94011,"max":394.011032},{"from":"BNB","to":"DCR","price":0.295687142857143,"pair":"BNB/DCR","min":36.968577,"max":3696.857671},{"from":"BTC","to":"SNT","price":233852.214797136,"pair":"BTC/SNT","min":0.05,"max":5.0},{"from":"LTC","to":"BNT","price":45.489,"pair":"LTC/BNT","min":7.183908,"max":718.390805},{"from":"BNB","to":"PHX","price":558.057142857143,"pair":"BNB/PHX","min":36.968577,"max":3696.857671},{"from":"ETH","to":"ZIL","price":6533.8175,"pair":"ETH/ZIL","min":1.933264,"max":193.326374},{"from":"BTC","to":"POWR","price":50222.5509482317,"pair":"BTC/POWR","min":0.05,"max":5.0},{"from":"BTC","to":"NAS","price":6132.56583229036,"pair":"BTC/NAS","min":0.05,"max":5.0},{"from":"LTC","to":"PHX","price":2936.73,"pair":"LTC/PHX","min":7.183908,"max":718.390805},{"from":"LTC","to":"ETH","price":0.26661,"pair":"LTC/ETH","min":7.183908,"max":718.390805},{"from":"BNB","to":"ICX","price":22.1153142857143,"pair":"BNB/ICX","min":36.968577,"max":3696.857671},{"from":"ETH","to":"XZC","price":17.9495,"pair":"ETH/XZC","min":1.933264,"max":193.326374},{"from":"XMR","to":"BRD","price":232.6,"pair":"XMR/BRD","min":3.94011,"max":394.011032},{"from":"LTC","to":"MANA","price":432.04,"pair":"LTC/MANA","min":7.183908,"max":718.390805},{"from":"LTC","to":"BAT","price":172.58,"pair":"LTC/BAT","min":7.183908,"max":718.390805},{"from":"ETH","to":"BNT","price":169.2975,"pair":"ETH/BNT","min":1.933264,"max":193.326374},{"from":"XMR","to":"POE","price":9073.25,"pair":"XMR/POE","min":3.94011,"max":394.011032},{"from":"XMR","to":"RVN","price":3246.6875,"pair":"XMR/RVN","min":3.94011,"max":394.011032},{"from":"XMR","to":"GRS","price":194.2475,"pair":"XMR/GRS","min":3.94011,"max":394.011032},{"from":"LTC","to":"OMG","price":18.3994,"pair":"LTC/OMG","min":7.183908,"max":718.390805},{"from":"BTC","to":"KNC","price":25364.7842868237,"pair":"BTC/KNC","min":0.05,"max":5.0},{"from":"BNB","to":"LTC","price":0.188441428571429,"pair":"BNB/LTC","min":36.968577,"max":3696.857671},{"from":"BNB","to":"SUB","price":104.729285714286,"pair":"BNB/SUB","min":36.968577,"max":3696.857671},{"from":"XMR","to":"LSK","price":35.939375,"pair":"XMR/LSK","min":3.94011,"max":394.011032},{"from":"XRP","to":"WAVES","price":0.1965148,"pair":"XRP/WAVES","min":564.334086,"max":56433.408578},{"from":"BNB","to":"DASH","price":0.0684642857142857,"pair":"BNB/DASH","min":36.968577,"max":3696.857671},{"from":"BNB","to":"POE","price":957.094285714286,"pair":"BNB/POE","min":36.968577,"max":3696.857671},{"from":"BNB","to":"ZIL","price":333.641,"pair":"BNB/ZIL","min":36.968577,"max":3696.857671},{"from":"LTC","to":"XEM","price":339.09,"pair":"LTC/XEM","min":7.183908,"max":718.390805},{"from":"ETH","to":"ELF","price":819.085,"pair":"ETH/ELF","min":1.933264,"max":193.326374},{"from":"ETH","to":"DNT","price":6531.5,"pair":"ETH/DNT","min":1.933264,"max":193.326374},{"from":"ETH","to":"BTC","price":0.0256695465,"pair":"ETH/BTC","min":1.933264,"max":193.326374},{"from":"ETH","to":"TUSD","price":85.6865,"pair":"ETH/TUSD","min":1.933264,"max":193.326374},{"from":"BTC","to":"CVC","price":62370.8492679822,"pair":"BTC/CVC","min":0.05,"max":5.0},{"from":"BTC","to":"DCR","price":220.959560315671,"pair":"BTC/DCR","min":0.05,"max":5.0},{"from":"ETH","to":"DGD","price":6.404275,"pair":"ETH/DGD","min":1.933264,"max":193.326374},{"from":"BNB","to":"GRS","price":20.4897142857143,"pair":"BNB/GRS","min":36.968577,"max":3696.857671},{"from":"ETH","to":"FUN","price":22229.775,"pair":"ETH/FUN","min":1.933264,"max":193.326374},{"from":"XRP","to":"CVC","price":5.52592,"pair":"XRP/CVC","min":564.334086,"max":56433.408578},{"from":"XRP","to":"SNT","price":20.7188,"pair":"XRP/SNT","min":564.334086,"max":56433.408578},{"from":"XRP","to":"ETH","price":0.0033991,"pair":"XRP/ETH","min":564.334086,"max":56433.408578},{"from":"BNB","to":"DOCK","price":487.438571428571,"pair":"BNB/DOCK","min":36.968577,"max":3696.857671},{"from":"XRP","to":"LOOM","price":6.7141,"pair":"XRP/LOOM","min":564.334086,"max":56433.408578},{"from":"ETH","to":"OMG","price":68.4745,"pair":"ETH/OMG","min":1.933264,"max":193.326374},{"from":"BTC","to":"QTUM","price":2030.66484662577,"pair":"BTC/QTUM","min":0.05,"max":5.0},{"from":"XRP","to":"TRX","price":22.7336,"pair":"XRP/TRX","min":564.334086,"max":56433.408578},{"from":"XRP","to":"GNT","price":4.59578,"pair":"XRP/GNT","min":564.334086,"max":56433.408578},{"from":"XRP","to":"SC","price":125.83759,"pair":"XRP/SC","min":564.334086,"max":56433.408578},{"from":"BNB","to":"XRP","price":14.7953571428571,"pair":"BNB/XRP","min":36.968577,"max":3696.857671},{"from":"ETH","to":"DASH","price":1.34075,"pair":"ETH/DASH","min":1.933264,"max":193.326374},{"from":"ETH","to":"AGI","price":2524.87425,"pair":"ETH/AGI","min":1.933264,"max":193.326374},{"from":"BTC","to":"TUSD","price":3313.76860118154,"pair":"BTC/TUSD","min":0.05,"max":5.0},{"from":"LTC","to":"POE","price":4970.41,"pair":"LTC/POE","min":7.183908,"max":718.390805},{"from":"LTC","to":"FUN","price":5973.23,"pair":"LTC/FUN","min":7.183908,"max":718.390805},{"from":"BTC","to":"DNT","price":252541.319587629,"pair":"BTC/DNT","min":0.05,"max":5.0},{"from":"BTC","to":"NANO","price":4146.12778705637,"pair":"BTC/NANO","min":0.05,"max":5.0},{"from":"XRP","to":"DNT","price":22.3747,"pair":"XRP/DNT","min":564.334086,"max":56433.408578},{"from":"XRP","to":"GTO","price":14.07,"pair":"XRP/GTO","min":564.334086,"max":56433.408578},{"from":"LTC","to":"EOS","price":12.7321,"pair":"LTC/EOS","min":7.183908,"max":718.390805},{"from":"LTC","to":"GRS","price":106.418,"pair":"LTC/GRS","min":7.183908,"max":718.390805},{"from":"LTC","to":"LOOM","price":526.64,"pair":"LTC/LOOM","min":7.183908,"max":718.390805},{"from":"XRP","to":"NANO","price":0.367346,"pair":"XRP/NANO","min":564.334086,"max":56433.408578},{"from":"ETH","to":"TRX","price":6636.125,"pair":"ETH/TRX","min":1.933264,"max":193.326374},{"from":"BTC","to":"AGI","price":97625.0879941003,"pair":"BTC/AGI","min":0.05,"max":5.0},{"from":"BTC","to":"DASH","price":51.840957084682,"pair":"BTC/DASH","min":0.05,"max":5.0},{"from":"XRP","to":"STORJ","price":2.29357,"pair":"XRP/STORJ","min":564.334086,"max":56433.408578},{"from":"ETH","to":"SC","price":36732.9475,"pair":"ETH/SC","min":1.933264,"max":193.326374},{"from":"ETH","to":"WAVES","price":57.36395,"pair":"ETH/WAVES","min":1.933264,"max":193.326374},{"from":"ETH","to":"IOST","price":22524.67,"pair":"ETH/IOST","min":1.933264,"max":193.326374}];
  // tradingPairs: TradingPair[];
  availableFrom = new Set<string>();
  availableTo = new Set<string>();
  activeTradingPair: TradingPair;
  agreement = false;
  subscription: ISubscription;

  readonly defaultFrom = 'BTC';
  readonly defaultFromAmount = '0.1';
  readonly defaultTo = 'SKY';

  get convertedAmount() {
    return (this.form.get('fromAmount').value * this.activeTradingPair.price).toFixed(6);
  }

  get sendAmount() {
    const val = this.form.get('fromAmount').value;

    return isNaN(parseFloat(val)) ? 0 : val;
  }

  get coinName() {
    return this.activeTradingPair ? this.activeTradingPair.to : this.defaultTo;
  }

  constructor(
    private exchangeService: ExchangeService,
    private formBuilder: FormBuilder,
    private snackbar: MatSnackBar,
  ) { }

  ngOnInit() {
    this.createForm();
    this.loadData();
  }

  ngOnDestroy() {
    this.subscription.unsubscribe();
    this.snackbar.dismiss();
  }

  setAgreement(event) {
    this.agreement = event.checked;
    this.form.updateValueAndValidity();
  }

  exchange() {
    this.exchangeButton.resetState();
    this.exchangeButton.setLoading();
    this.exchangeButton.setDisabled();

    const amount = parseFloat(this.form.get('fromAmount').value);

    this.exchangeService.exchange(
      this.activeTradingPair.pair,
      amount,
      this.form.get('toAddress').value,
    ).subscribe((order: ExchangeOrder) => {
      this.exchangeService.setLastOrder(order);
      this.submitted.emit(order);
    }, err => {
      this.exchangeButton.resetState();
      this.exchangeButton.setEnabled();
      this.exchangeButton.setError(err);
      showSnackbarError(this.snackbar, err);
    });
  }

  private loadData() {
    // this.exchangeService.tradingPairs().subscribe(pairs => {
    //   this.tradingPairs = pairs;

      this.tradingPairs.forEach(pair => {
        this.availableFrom.add(pair.from);

        if (pair.from === this.defaultFrom) {
          this.availableTo.add(pair.to);
        }
      });

      this.activeTradingPair = this.tradingPairs.find(p => {
        return p.pair === `${this.defaultFrom}/${this.defaultTo}`;
      });

      this.updateToAmount();
    // });
  }

  private createForm() {
    this.form = this.formBuilder.group({
      from: [this.defaultFrom, Validators.required],
      fromAmount: [this.defaultFromAmount, Validators.required],
      to: [this.defaultTo, Validators.required],
      toAmount: ['', Validators.required],
      toAddress: ['', Validators.required],
    }, {
      validator: this.validate.bind(this),
    });

    this.subscription = Observable.merge(
      this.form.get('from').valueChanges,
      this.form.get('fromAmount').valueChanges,
      this.form.get('to').valueChanges,
    ).subscribe(() => {
      this.activeTradingPair = this.tradingPairs.find(p => {
        return p.pair === `${this.form.get('from').value}/${this.form.get('to').value}`;
      });

      if (!this.activeTradingPair) {
        this.activeTradingPair = this.tradingPairs.find(p => p.from === this.form.get('from').value);
        this.form.get('to').setValue(this.activeTradingPair.to);
      }

      this.updateToAmount();
    });
  }

  private updateToAmount() {
    this.form.get('toAmount').setValue(this.convertedAmount);
  }

  private validate(group: FormGroup) {
    if (!group || !this.activeTradingPair) {
      return null;
    }

    const fromAmount = group.get('fromAmount').value;

    if (isNaN(parseFloat(fromAmount))) {
      return { invalid: true };
    }

    if (fromAmount < this.activeTradingPair.min) {
      return { min: this.activeTradingPair.min };
    }

    if (fromAmount > this.activeTradingPair.max) {
      return { max: this.activeTradingPair.max };
    }

    if (!this.agreement) {
      return { agreement: true };
    }

    return null;
  }
}
